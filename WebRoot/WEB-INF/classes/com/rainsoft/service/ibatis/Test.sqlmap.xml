<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
		"http://www.ibatis.com/dtd/sql-map-2.dtd">
<!-- iBatis SQL Map 文件 -->
<sqlMap namespace="test">

	<typeAlias alias="values" type="com.rainsoft.tools.model.ActionValues"/>
	<typeAlias alias="Result" type="com.rainsoft.tools.model.DataValues"/>
	
	<select id="query" remapResults="true" resultClass="Result" parameterClass="values">
	   <isNotEmpty property="sqlHeader">
			<![CDATA[   
				$sqlHeader$  
			]]>
		</isNotEmpty>
	         select t.* from test t
	         
	         <dynamic prepend="where">
	             <isNotEmpty prepend="and" property="id">
	                  t.id=#id#
	             </isNotEmpty>
	             <isNotEmpty prepend="and" property="userName">
	                  t.user_name like '%$userName$%'
	             </isNotEmpty>
	             <isNotEmpty prepend="and" property="birth">
	                  t.birth=#birth#
	             </isNotEmpty>
	             <isNotEmpty prepend="and" property="sex">
	                  t.sex=#sex#
	             </isNotEmpty>
	             <isNotEmpty prepend="and" property="opt">
	                  t.opt like '%$opt$%'
	             </isNotEmpty>
	         </dynamic>
	       
	       <isNotEmpty property="orderBy">
				order by $orderBy$ $order$
			</isNotEmpty>
			<isEmpty property="orderBy">
				order by ID
			</isEmpty>
	    <isNotEmpty property="sqlFooter">
				<![CDATA[ 	
			  		$sqlFooter$    
			  	]]>
		</isNotEmpty>
	</select>
	
	<insert id="insertTest" parameterClass="values">
	     insert into test
	     (
	       id,
	       user_name,
	       birth,
	       sex,
	       opt
	     )
	     values
	     (
	       gener.nextval,
	       #user_name#,
	       #birth#,
	       #sex#,
	       #opt#
	     )
	</insert>
	
	<update id="updateTest" parameterClass="values">
	    update test 
	    <dynamic prepend="set">
	        <isNotEmpty prepend="and" property="id">
	               id=#id#
	        </isNotEmpty>
	        <isNotEmpty prepend="and" property="userName">
	               user_name=#userName#
	        </isNotEmpty>
	        <isNotEmpty prepend="and" property="birth">
	               birth=#birth#
	        </isNotEmpty>
	        <isNotEmpty prepend="and" property="sex">
	               sex=#sex#
	        </isNotEmpty>
	        <isNotEmpty prepend="and" property="opt">
	               opt=#opt#
	         </isNotEmpty>
	    </dynamic>
	    where id=#id#
	</update>
	
	<delete id="deleteTest" parameterClass="string">
	     delete * from test where id=#id#
	</delete>
	
</sqlMap>
